cmake_minimum_required(VERSION 3.0.2)

project(phi)

if (APPLE)
    add_definitions(-DAPPLE)
    set(os osx)
    set(CMAKE_XCODE_ATTRIBUTE_CLANG_CXX_LANGUAGE_STANDARD "c++0x")
    set(CMAKE_XCODE_ATTRIBUTE_CLANG_CXX_LIBRARY "libc++")
elseif (WIN32)
    add_definitions(-DWIN32)
    set(os win32)
endif (APPLE)

#if (NOT CMAKE_BUILD_TYPE)
#	set(CMAKE_BUILD_TYPE "Debug" CACHE STRING "Build Type: Debug|Release")
#endif()

add_subdirectory(content/core)
add_subdirectory(content/rendering)
add_subdirectory(content/ui)
add_subdirectory(content/demo)

if ( WIN32 )
    set_target_properties(core PROPERTIES RUNTIME_OUTPUT_DIRECTORY ../../)
    set_target_properties(core PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG ../../debug)
    set_target_properties(core PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE ../../release)
    set_target_properties(rendering PROPERTIES RUNTIME_OUTPUT_DIRECTORY ../../ )
    set_target_properties(rendering PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG ../../debug)
    set_target_properties(rendering PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE ../../release)
    set_target_properties(ui PROPERTIES RUNTIME_OUTPUT_DIRECTORY ../../)
    set_target_properties(ui PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG ../../debug)
    set_target_properties(ui PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE ../../release)
    set_target_properties(demo PROPERTIES RUNTIME_OUTPUT_DIRECTORY ../../)
    set_target_properties(demo PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG ../../debug)
    set_target_properties(demo PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE ../../release)
endif ( WIN32 )

set (dlls_dir ${CMAKE_CURRENT_SOURCE_DIR}/libs/${os})
set (fonts_dir ${CMAKE_CURRENT_SOURCE_DIR}/resources/fonts)
set (models_dir ${CMAKE_CURRENT_SOURCE_DIR}/resources/models)
set (shaders_dir ${CMAKE_CURRENT_SOURCE_DIR}/resources/shaders)
set (textures_dir ${CMAKE_CURRENT_SOURCE_DIR}/resources/textures)

if (WIN32)
    file(GLOB dll_files ${dlls_dir}/*.dll)
elseif(APPLE)
    file(GLOB dll_files ${dlls_dir}/*.*)
endif()

file(GLOB font_files ${fonts_dir}/*.*)
file(GLOB model_files ${models_dir}/*.*)
file(GLOB shader_files ${shaders_dir}/*.*)
file(GLOB texture_files ${textures_dir}/*.*)

foreach( OUTPUTCONFIG ${CMAKE_CONFIGURATION_TYPES} )
	string( TOLOWER ${OUTPUTCONFIG} OUTPUTCONFIG )
	set (dir ${CMAKE_CURRENT_SOURCE_DIR}/build/${OUTPUTCONFIG})
	#message(${dir})
	install(FILES ${dll_files} DESTINATION ${dir})
	install(FILES ${font_files} DESTINATION ${dir}/resources/fonts)
	install(FILES ${model_files} DESTINATION ${dir}/resources/models)
	install(FILES ${shader_files} DESTINATION ${dir}/resources/shaders)
	install(FILES ${texture_files} DESTINATION ${dir}/resources/textures)
endforeach( OUTPUTCONFIG CMAKE_CONFIGURATION_TYPES )